trigger:
- none

pool:
  vmImage: ubuntu-latest

stages:
  - stage: Build_Stage
    displayName: :Build json files for ARM template
    jobs:
    - job: ARM-file-creation
      displayName: 'ARM file creation'
      pool: 
        vmImage: 'windows-2019'
      variables:
        buildConfiguration: 'Release'
      steps:

      - task: CopyFiles@2
        displayName: 'copy files to Build.ArtifactStagingDirectory'
        inputs:
          SourceFolder: 'AzureResourceGroupDeployment'
          Contents: '*.json'
          TargetFolder: '$(Build.ArtifactStagingDirectory)'

      - task: PublishBuildArtifacts@1
        displayName: 'publish artifacts to drop folder'
        inputs:
          PathtoPublish: '$(Build.ArtifactStagingDirectory)'
          ArtifactName: 'drop'

  - stage: Deploy_Stage
    dependsOn: 'Build_Stage'
    displayName: :'Deploy ARM templates to Azure'
    jobs:
    - job: ARM-file-deploy
      displayName: 'ARM file deploy to Azure'
      pool: 
        vmImage: 'windows-2019'
      variables:
        buildConfiguration: 'Release'
      steps: 

      
